# CalcPaper 使用指南

版本：1.0

## 目录

- [简介](#简介)
- [安装与运行](#安装与运行)
- [基本功能](#基本功能)
- [高级功能](#高级功能)
- [GUI界面使用](#gui界面使用)
- [命令行使用](#命令行使用)
- [常见问题](#常见问题)

## 简介

CalcPaper（计算稿纸）是一款专为程序员设计的智能计算器，支持变量引用、位运算、16进制/2进制数值，让复杂计算像在纸上写算式一样简单。

## 安装与运行

### 系统要求

- Python 3.6+
- tkinter（Python自带，GUI版本需要）

### 运行方式

```bash
# GUI版本（推荐）
python calc_paper_gui.py

# 命令行版本（中文）
python calc_paper.py

# 命令行版本（英文）
python calc_paper.py --lang en

# 查看版本
python calc_paper.py --version

# 查看帮助
python calc_paper.py --help
```

## 基本功能

### 1. 四则运算

```python
# 基本运算
a = 100
b = 200
和 = a + b
差 = b - a
积 = a * b
商 = b / a
```

### 2. 变量引用

```python
# 定义变量后可以直接使用
工资 = 8000
房租 = 2000
餐费 = 30 * 25
结余 = 工资 - 房租 - 餐费
```

### 3. 百分数计算

```python
# 直接使用百分号
原价 = 299
折扣 = 20%
折后价 = 原价 * (1 - 折扣)

# 或者
优惠金额 = 原价 * 折扣
实付 = 原价 - 优惠金额
```

### 4. 注释

```python
# 这是注释，不会被计算
价格 = 100  # 行内注释也支持
```

## 高级功能

### 1. 16进制数值

```python
# 使用 0x 前缀
a = 0xFF        # 255
b = 0x1A2B      # 6699
c = 0xDEADBEEF  # 3735928559
```

### 2. 2进制数值

```python
# 使用 0b 前缀
flag1 = 0b1010      # 10
flag2 = 0b11110000  # 240
```

### 3. 位运算

```python
# 左移 <<
a = 0b1010
左移2位 = a << 2  # 0b101000 = 40

# 右移 >>
b = 0xFF
右移4位 = b >> 4  # 0x0F = 15

# 按位与 &
与运算 = 0xFF & 0x0F  # 0x0F = 15

# 按位或 |
或运算 = 0xF0 | 0x0F  # 0xFF = 255

# 按位异或 ^
异或运算 = 0xFF ^ 0xAA  # 0x55 = 85

# 按位取反 ~
取反 = ~0b1010  # -11（补码表示）
```

### 4. 字节序显示

```python
# 设置小端字节序
endian: little

# 设置大端字节序
endian: big

# 关闭字节序显示
endian: none
```

### 5. bitmap 关键字

使用 `bitmap` 关键字可以查看数值的详细位结构：

```python
# 设置字节序
endian: big

# 普通计算（只显示十进制）
a = 0xFF

# 使用 bitmap 查看位结构
bitmap 查看a = a
```

输出：
```
a = 0xFF                    = 255
bitmap 查看a = a            = 255 (0xFF, 0b11111111)
  十六进制: 0xFF
  二进制: 0b11111111
  位数: 8 bits (1 bytes)
  位索引 (大端字节序):
    |7 6 5 4 |3 2 1 0 |
    |1 1 1 1 |1 1 1 1 |
```

## GUI界面使用

### 界面布局

- 左侧：输入区域
- 右侧：输出区域（带语法高亮）
- 底部：功能按钮和状态栏

### 快捷键

- `F5` 或 `Ctrl+Enter`：计算
- `Ctrl+D`：清空
- `Ctrl+L`：加载示例
- `Ctrl+O`：打开文件
- `Ctrl+S`：保存结果
- `Ctrl+Plus` 或 `Ctrl+=`：放大字体
- `Ctrl+Minus` 或 `Ctrl+-`：缩小字体

### 功能按钮

- **计算**：执行计算并显示结果
- **清空**：清空输入和输出区域
- **加载示例**：加载预设示例
- **打开文件**：从文件加载计算内容
- **保存结果**：将结果保存到文件
- **EN/中文**：切换中英文界面
- **A+**：放大字体
- **A-**：缩小字体

### 语法高亮

输出区域会自动应用语法高亮：

- 绿色：计算结果
- 灰色：注释
- 红色：错误信息
- 蓝色：总计
- 紫色：字节序设置
- 深蓝色：位信息

## 命令行使用

### 交互模式

```bash
# 启动程序
python calc_paper.py

# 输入计算内容（可以多行）
a = 100
b = 200
sum = a + b

# 输入 calc 开始计算
calc

# 继续输入或输入 exit 退出
```

### 命令行参数

```bash
# 使用英文界面
python calc_paper.py --lang en

# 查看版本
python calc_paper.py --version

# 查看帮助
python calc_paper.py --help
```

### 特殊命令

- `calc`：开始计算
- `clear`：清空输入
- `exit` 或 `quit`：退出程序

## 常见问题

### 1. 如何查看变量的位结构？

使用 `bitmap` 关键字：

```python
endian: big
bitmap 变量名 = 表达式
```

### 2. 为什么位运算结果显示为负数？

按位取反 `~` 操作会产生负数（补码表示）。如果需要正数结果，可以使用掩码：

```python
a = 0b1010
取反 = ~a & 0xFF  # 限制在8位范围内
```

### 3. 如何切换大小端字节序？

使用 `endian` 命令：

```python
endian: little  # 小端
endian: big     # 大端
endian: none    # 关闭
```

### 4. 支持哪些数值格式？

- 十进制：`123`、`456.78`
- 十六进制：`0xFF`、`0x1A2B`
- 二进制：`0b1010`、`0b11110000`
- 百分数：`15%`、`6.5%`

### 5. 变量名可以使用中文吗？

可以！支持中文、英文、数字和下划线的组合：

```python
价格 = 100
折扣 = 15%
实付 = 价格 * (1 - 折扣)
```

### 6. 如何保存计算结果？

GUI版本：点击"保存结果"按钮或按 `Ctrl+S`

命令行版本：使用重定向
```bash
python calc_paper.py < input.txt > output.txt
```

### 7. 如何放大/缩小字体？

GUI版本：
- 点击 A+ / A- 按钮
- 或使用快捷键 `Ctrl+Plus` / `Ctrl+Minus`

### 8. 如何切换中英文界面？

GUI版本：点击"EN"或"中文"按钮

命令行版本：使用 `--lang` 参数
```bash
python calc_paper.py --lang en
```

## 实用示例

### RGB颜色处理

```python
endian: big

# 颜色值
颜色 = 0xFF8040

# 提取RGB分量
红色 = (颜色 >> 16) & 0xFF
绿色 = (颜色 >> 8) & 0xFF
蓝色 = 颜色 & 0xFF

# 查看位结构
bitmap 查看颜色 = 颜色
```

### IP地址解析

```python
# IP地址 192.168.0.1
IP = 0xC0A80001

# 提取各段
段1 = (IP >> 24) & 0xFF  # 192
段2 = (IP >> 16) & 0xFF  # 168
段3 = (IP >> 8) & 0xFF   # 0
段4 = IP & 0xFF          # 1
```

### 位标志管理

```python
# 定义标志位
FLAG_READ = 0b0001
FLAG_WRITE = 0b0010
FLAG_EXECUTE = 0b0100
FLAG_DELETE = 0b1000

# 组合权限
权限 = FLAG_READ | FLAG_WRITE

# 检查权限
有读权限 = 权限 & FLAG_READ
有执行权限 = 权限 & FLAG_EXECUTE
```

### 财务计算

```python
# 月度预算
工资 = 8000
房租 = 2000
水电 = 300
餐费 = 30 * 25
交通 = 200

# 总支出
总支出 = 房租 + 水电 + 餐费 + 交通

# 结余
结余 = 工资 - 总支出

# 储蓄率
储蓄率 = 结余 / 工资 * 100%
```

## 技巧与最佳实践

1. **使用有意义的变量名**：让计算过程更清晰
2. **添加注释**：说明计算目的和逻辑
3. **合理使用 bitmap**：只在需要查看位结构时使用
4. **选择合适的字节序**：根据实际应用场景选择
5. **保存常用计算**：将常用计算保存为文件，方便重复使用

## 更多资源

- [位运算快速参考](位运算快速参考.md)
- [16进制注释格式说明](16进制注释格式说明.md)
- [bitmap关键字说明](bitmap关键字说明.md)
